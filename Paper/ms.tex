\documentclass[useAMS,usenatbib]{mn2e}

\voffset=-0.8in

% Packages:
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{xspace}
\usepackage{dsfont}

% Bold symbols
%\renewcommand{\theta}{\boldsymbol{\theta}}
%\newcommand{D}{\boldsymbol{D}}
\newcommand{\bx}{\{x_i\}}

% \onecolumn
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title[]
{Fast Bayesian Inference for Exoplanet Discovery in Radial Velocity Data}
    
\author[Brewer and Donovan]{%
  Brendon~J.~Brewer$^{1}$\thanks{bj.brewer@auckland.ac.nz},
  Courtney P. Donovan$^{1}$
  \medskip\\
  $^1$Department of Statistics, The University of Auckland, Private Bag 92019, Auckland 1142, New Zealand}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
             
\date{To be submitted to MNRAS}
             
\maketitle

\label{firstpage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}
Inferring the number of planets $N$ in an exoplanetary system from radial velocity
(RV) data is a challenging task. Recently, it has become clear that RV data
can contain periodic signals due to stellar activity, which can be difficult
to distinguish from planetary signals. However, even doing the inference
under a given set of simplifying assumptions (e.g. no stellar activity) can
be difficult. It is common for the posterior distribution for the
planet parameters, such as orbital periods,
to be multimodal and to have other awkward features. In
addition, when $N$ is unknown, the marginal likelihood (or evidence), as a
function of $N$, is required. Rather than doing separate runs with different
values of $N$, we propose an alternative
approach using a trans-dimensional Markov Chain Monte Carlo method within
Nested Sampling. The posterior distribution for $N$ can be obtained with a
single run, which takes $\sim$ 15 minutes on a typical modern desktop computer.
We apply the method to $\nu$ Oph and Gliese 581, finding moderate evidence
for additional signals in
$\nu$ Oph with periods of 36.11 $\pm$ 0.034 days,
75.58 $\pm$ 0.80 days, and 1709 $\pm$ 183 days;
the posterior probability that at least one of these
exists is 85\%. The results also suggest Gliese 581 hosts many (7-15) ``planets''
(or other causes of other periodic
signals), but only four have well determined periods. The analysis of both
of these datasets shows phase transitions exist which are difficult to
negotiate without Nested Sampling.
\end{abstract}

\begin{keywords}
stars: planetary systems --- techniques: radial velocities ---
methods: data analysis --- methods: statistical
\end{keywords}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
The number of known extrasolar planets has exploded in the last two
decades. This has been driven by improvements in
all of the different techniques used to detect and characterise exoplanets,
including the radial velocity (RV) method \citep[e.g.][]{2012PASJ...64..135S},
the transit method \citep[e.g.]{2014PNAS..11112647B},
and gravitational microlensing
\citep[e.g.][]{2014ApJ...785..155B, 2014ApJ...790...14Y}.

The problem of inferring the properties of an
exoplanetary system from observational data can be challenging.
In the particular case of radial velocity data,
the expected signal due to an exoplanet is periodic, and the goal is to
infer the number of planets in the system, as well as their properties such
as orbital periods and eccentricities. Many
different techniques have been proposed for doing this.
These techniques fall into two main
classes: i) those based on periodograms \citep[e.g.][]{2009A&A...496..577Z},
and ii) those based on model fitting in the Bayesian inference framework,
to describe the uncertainties probabilistically
\citep[e.g.][]{2011MNRAS.410...94G, 2014MNRAS.437.3540F,
2011A&A...528L...5T, fengji}. Bayesian model fitting via Markov Chain Monte
Carlo (MCMC) tends to be very computationally intensive, especially if we
want to calculate the posterior distribution for $N$, the number of planets.

It is now well known that RV datasets can contain periodic signals
resulting from stellar activity rather than planets \citep{2014Sci...345..440R}.
Therefore, it is important to develop models which attempt to distinguish
stellar activity signals from Keplerian planet signals based on the shape of
the oscillations and/or additional data constraining the periods of any
stellar activity signals. We do not address this important challenge in the
present paper. Rather, we consider the problem of inferring the number $N$ of
Keplerian signals in an RV dataset in a computationally efficient way.

We introduce a trans-dimensional birth-death MCMC approach
\citep{birthdeath} to inferring $N$.
When $N$ is treated as just another model parameter, we can obtain its
posterior distribution in a single run.
The exploration is done using Diffusive Nested Sampling
\citep[DNS][]{dnest} which replaces the posterior distribution with an alternative
{\it mixture of constrained priors}, allowing mixing between separated modes.
As a result, we are able to sample the posterior distribution for $N$, and
evaluate the marginal likelihood (including the sum over $N$) in
a single run which takes about 10 minutes on a 2-3 planet system.
On the other hand the approach of
\citet{2011MNRAS.410...94G} takes approximately 30 minutes per planet
(Gregory, priv. comm.). A C++ implementation of our method is available online
at {\tt https://github.com/eggplantbren/Exoplanet} under the terms of the
GNU General Public Licence version 3.

\section{Inference}
Bayesian inference is the use of probability theory to describe uncertainty
\citep{sivia, ohagan}. In this framework, we approach data analysis problems by first
constructing a {\it hypothesis space}, which is the set of possible answers
to the problem we are considering. Normally, this is the set of possible
values of a vector of parameters $\theta$ whose values we want
to know. We then assign probability distributions
called the {\it prior} and the {\it sampling distribution}. The prior
distribution $p(\theta)$ describes
our initial uncertainty about which values of the parameters
$\theta$ are plausible, and the
sampling distribution $p(D | \theta)$ describes
our initial uncertainty about the data set we're going to observe, as a
function of the unknown parameters $\theta$.
When the data is known, our state of knowledge about the parameter is
updated from the prior $p(\theta)$ to the posterior distribution given by
Bayes' rule:
\begin{eqnarray}
p(\theta | D) &=&
\frac{p(\theta)p(D | \theta)}
{p(D)}
\end{eqnarray}
where $p(D | \theta)$ is called the likelihood, once the actual dataset
is substituted in. Note that some authors do not distinguish between a
sampling distribution and a likelihood. Throughout this paper we use the term
sampling distribution for $p(D|\theta)$ if we are discussing a probability
distribution (actually a family of them, indexed by $\theta$)
over the set of possible datasets. We use the term {\it likelihood}
when the actual dataset has been plugged in, when $p(D|\theta)$
becomes a scalar function (not a probability distribution)
over the parameter space.

The denominator, often called the {\it evidence} or
{\it marginal likelihood}, is given by the expected value of the likelihood
with respect to the prior:
\begin{eqnarray}
\mathcal{Z} = p(D) = \int p(\theta) p(D | \theta) d^n \theta
\end{eqnarray}
where the integral is over the entire $n$-dimensional parameter space.
In the context of Bayesian computation, the prior is often denoted $\pi(\theta)$,
the likelihood $L(\theta)$, and the marginal likelihood $\mathcal{Z}$.

\subsection{Inferring the number of planets}
The number of orbiting planets, $N$, is an important parameter.
To calculate the posterior distribution for $N$, most authors
consider various trial values of $N$, and calculate the marginal likelihood
\begin{eqnarray}
p(D | N) &=& \int p(\theta | N) p(D | \theta, N) \, d^n \theta
\end{eqnarray}
for each possible value of $N$
\citep[e.g.][]{2011MNRAS.415.2523G, 2011MNRAS.415.3462F, 2014MNRAS.437.3540F, fengji}, marginalising
over all other model parameters.
The posterior distribution for $N$ can then be found straightforwardly by
using Bayes' rule with $N$ as the only unknown parameter:
\begin{eqnarray}
p(N | D) &=& \frac{p(N)p(D | N)}{\sum_N p(N)p(D | N)}.
\end{eqnarray}
Popular
methods for calculating the marginal likelihood are Nested Sampling
\citep{skilling} and ideas related to thermodynamic integration
\citep[e.g.][]{neal}.

This traditional approach can be very time consuming.
Methods for calculating the marginal likelihood are
already more intensive than standard MCMC methods for sampling the posterior,
because they usually involve a sequence of probability distributions
(e.g. the constrained priors in Nested Sampling, or the annealed distributions
in thermodynamic integration) rather than a single distribution (the posterior).
This intensive process needs to be run many times, for $N=0$, $N=1$, $N=2$, and
so on.

The traditional approach to inferring $N$ also contradicts
fundamental ideas in Bayesian
computation. Imagine we are trying to compute the posterior distribution for
a parameter $a$ in the presence of a nuisance parameter $b$. This is usually solved
by exploring the joint posterior for $a$ and $b$, and then only looking at the
generated values of $a$. Nobody would suggest the wasteful alternative
of using a discrete grid of possible $a$ values and doing an entire Nested
Sampling run for each, to get the marginal likelihood as a function of $a$.
When the hypothesis space for $a$ is discrete, MCMC is still possible and there
is no reason to switch to the wasteful alternative.

\subsection{Trans-dimensional MCMC}
Trans-dimensional MCMC methods such as birth-death MCMC \citep{birthdeath} or the
more general reversible jump MCMC \citep{green} treat the model dimension
$N$ as just another model parameter. At fixed $N$, standard techniques such
as the Metropolis algorithm can be used to explore the posterior distribution.
Additional moves that propose to change the value of $N$ are also defined. The
simplest of these are birth-death moves. More complicated moves, such as
split-and-merge \citep[e.g.][]{umstatter} are possible but usually not necessary.

In the exoplanet context, a birth move
proposes to add one more planet to the model. The new planet's properties
(period, amplitude, eccentricity, etc) are drawn from their prior distribution
which may depend on other other model parameters or hyperparameters.
The corresponding death move simply chooses a planet currently in the model,
and removes it. The acceptance probability for these moves is 1 if we want
to explore the prior. To implement these moves in Nested Sampling
\citep{skilling}, where the target distribution is proportional to the prior but with a hard likelihood
constraint, then the acceptance probability is 1 if the proposed move
satisfies the likelihood constraint, and 0 if it does not.

A recent paper \citep{rjobject} introduced a general approach to implementing
trans-dimensional models within Diffusive Nested Sampling \citep{dnest}, a
general MCMC algorithm. The \citet{rjobject} software predefines the
Metropolis proposals for exploring trans-dimensional target distributions,
including when the prior for the properties of each model component (i.e. each
planet) is defined hierarchically.

\subsection{Phase transitions}
It is well known that Bayesian computation (using MCMC for example) can be
difficult when the posterior distribution is multimodal or has strong
dependencies between parameters. An uncommon but less well-known difficulty
is the existence of {\it phase transitions} \citep{skilling}.

Imagine a high-dimensional unimodal posterior distribution that is composed of a
broad, high volume but low density ``slab'' with a narrow, low volume but high
density ``spike'' on top of it.
An example is a mixture of two concentric high-dimensional gaussians with
different widths. If you ran MCMC on such a posterior, it would be difficult
to jump between the slab and the spike components. If the MCMC is currently
in the spike region (or phase) it will be unable to escape: a proposed move
into the slab will be rejected because of the ratio of densities. Conversely,
if the MCMC was in the slab region, it would be unlikely to go into the spike
region, because its volume is so small: it would be very unlikely to
{\it propose} to move into the spike. Thus, the situation behaves much like
a multimodal posterior, despite only being unimodal.

If the slab contains a very small amount of posterior probability, it is not
a problem if an MCMC algorithm spends all its time in the spike. However, this
situation could still cause problems with the calculation of the marginal likelihood
if annealing methods are used. The thermodynamic integral formula gives
the log of the marginal likelihood $\mathcal{Z}$ as an average of log likelihoods:
\begin{eqnarray}
\log(\mathcal{Z}) &=& \int_0^1 \left<\log\left[L(\theta)\right]\right>_\beta \, d\beta
\end{eqnarray}
where the expectation is taken with respect to the
distribution with ``inverse temperature'' $\beta$, proportional to
$\pi(\theta)L(\theta)^\beta$. Even if the slab contains virtually zero probability
when $\beta=1$ (i.e. the posterior), for some values of the inverse temperature
$\beta$ the slab and the spike will both be important. At
these temperatures the MCMC will fail to mix (it will incorrectly spend all its
time in either the slab or the spike, rather than mixing between the two)
and will give a misleading estimate of the average log likelihood at that temperature.

In data analysis problems, phase transitions can exist when the data contains
a ``big'' effect which provides a lot of information about some parameters, and
a ``small'' subtle effect.
Nested Sampling, and variants such as DNS, are not affected
by phase transitions because the exploration only makes use of likelihood
{\it rankings}, rather than likelihood values themselves.
Part of their output, the relationship between the
likelihood $L$ and the enclosed prior mass
$X(L) = \int \pi(\theta) \mathds{1}\left[L(\theta) > L\right]\, d^n\theta$
can be used to diagnose whether the
problem contains a phase transition. In particular, if the graph of $\log(L)$
vs. $\log(X)$ is convex at some point, then a phase transition exists
\citep{skilling}.

\subsection{Parameters and Priors}
To fit a planet model to RV data, we need parameters to describe
the properties of each planet. For simplicity, we describe each planet by
five parameters: the orbital period $P_i$, the semi-amplitude (in metres
per second) of the RV signal $A_i$, the phase of the signal
$\phi_i$ (defined such that $\phi=0$ gives an RV signal whose maximum is at
$t=0$), the eccentricity $e_i$, and the ``viewing angle'' $\omega_i$
(also known as the longitude of the line of sight). We defined our parameters
such that in the limit of zero eccentricity, the RV signal of a planet
reduces to $A_i\cos\left(2\pi t/P_i + \phi_i\right)$.

We assigned hierarchical priors to some of the planet's parameters. This allows the
model to capture the idea that knowing the values of some planet's parameters
provides some information about the parameters of another planet. Not using
hierarchical priors usually implies a strong prior commitment to the hypothesis
that the properties of the planets are spread out across the whole domain of
possible values, which is not necessarily the case.

The unknown parameters are:
\begin{eqnarray}
\left\{N, \boldsymbol{\alpha}, \{\boldsymbol{\psi}\}_{i=1}^N, m_0, \sigma_{\rm extra}, \nu\right\}
\end{eqnarray}
where $N$ is the number of planets,
$\boldsymbol{\alpha} = \{\mu_P, \sigma_P, \mu_A\}$ are the
hyperparameters used to define the prior for the properties of the planets,
and $\psi_i = \{P_i, A_i, e_i, \phi_i, \omega_i\}$
are the properties of planet $i$.
The parameter $m_0$ describes a DC offset in the data, and
$\sigma_{\rm extra}$ and $\nu$ are parameters of the noise distribution
which are discussed further below.

A standard assumption for the probability distribution of the data given the
parameters (known as the sampling distribution, which becomes the likelihood
function when the dataset is known) is a normal distribution with
standard deviation $\sigma_i$ known from the error bars in the data set.
However, it is usually recommended to put in ``safety features'', in case the
data set contains any discrepant measurements, or in case the error bars in the
data set are underestimated. To achieve this, we used a student-$t$ distribution
instead of a normal distribution, with
scale parameter $\sqrt{\sigma_i^2 + \sigma_{\rm extra}^2}$ and shape parameter $\nu$. The
parameter $\sigma_{\rm extra}$ is an ``extra noise'' parameter that effectively increases the
size of the error bars, and the shape parameter $\nu$ allows for heavier tails
than a normal distribution. If $\nu$ is large, the student-$t$ distribution
is approximately a normal distribution, and if $\nu$ is small the noise
distribution has much heavier tails. For instance, when $\nu=1$ the student-$t$
distribution becomes a Cauchy distribution.

All of the model assumptions are specified in detail in
Table~\ref{tab:priors}. Most of these priors were chosen to represent vague
prior knowledge, rather than the judgement of an informed expert on extrasolar
planets. Uniform distributions were used for parameters such as phases, where
time-translation symmetry seems plausible.
Truncated Cauchy distributions were used when there is a
preferred value, but since these have very heavy tails, the assumption is
quite fail safe relative to other possible assignments such as normal distributions.
For example, the prior for $\mu_P$, the typical orbital period,
is centered around 1 year but could be as low as $\approx e^{-21}$ years or as high
as $\approx e^{21}$ years, a very generous range. Truncation intervals are
specified with the $T(a,b)$ notation in Table~\ref{tab:priors}.

An apparently strange choice is the conditional prior for the (logarithms of)
the orbital
periods, which is a biexponential distribution. A more conventional choice
would have been a normal distribution. However, the \citet{rjobject} software
needs to know the corresponding cumulative distribution and its inverse, which
are not available in closed form for the normal distribution.
The prior for the velocity semi-amplitudes $\{A_i\}$ is important and will affect the
inferred number of planets $N$. For example, if the prior allows for very
low amplitude planets to exist, the data will not rule this out, and the posterior
for $N$ will include the possibility of large numbers of planets. The prior
will influence how many of these low amplitude planets will exist: if we
believe there are many, and the data are uninformative about low amplitude
planets, then the posterior distribution for $N$ will also indicate that there
may be many low amplitude planets. However, their other properties, such as
their orbital periods, will not be well determined. The Beta prior for
eccentricity was suggested by Gregory (priv. comm) and is an approximation
to the inferred frequency distribution of eccentricities in the population
\citep{kipping}.

\begin{table*}
\begin{tabular}{|l|l|l|}
\hline
Quantity	&	Meaning		& Prior\\
\hline
{\bf Hyperparameters}	&	\\
$N$		& Number of planets	& Uniform$(\{0, 1, ..., N_{\rm max}\})$\\
$\mu_P$		&	Median orbital period	& $\log(\mu_P) \sim$ Cauchy$(5.9, 1)T(-15.3, 27.1)$\\
$w_P$		&	Diversity of orbital periods & $w_P \sim$ Uniform$(0.1, 3)$\\
$\mu_A$		&	Mean amplitude	& $\log(\mu_A) \sim$ Cauchy$(0, 1)T(-21.2, 21.2)$\\
\hline
{\bf Planet Parameters}\\
$P_i$		&	Orbital period	&	$\log(P_i) \sim $ Biexponential($\log(\mu_P), w_P$)\\
$A_i$		&	Amplitude of signal	& Exponential$(\textnormal{mean}=\mu_A)$\\
$\phi_i$	&	Phase of signal	&	Uniform($0, 2\pi$)\\
$e_i$		&	Eccentricity of orbit	&	Beta$(1, 3.1)T(0, 0.8)$\\
$\omega_i$	&	Viewing angle	&	Uniform$(0, 2\pi)$\\
\hline
{\bf Other}\\
$m_0$		&	Constant DC offset	&	Uniform$(m_{0, \rm min}, m_{0, \rm max})$\\
$\sigma_{\rm extra}$	& ``Extra noise'' parameter	& $\log(\sigma) \sim$ Cauchy$(0, 1)T(-21.2, 21.2)$\\
$\nu$		& Shape parameter for $t$-distribution for noise & $\log(\nu) \sim$ Uniform$(\log(0.01), \log(1000))$\\
\hline
{\bf Data}\\
$Y_i$		& Radial velocity measurements	&
		Student-$t\left(m(t_i), \sqrt{\sigma_i^2 + \sigma_{\rm extra}^2}, \nu\right)$
\end{tabular}
\caption{All of the prior distributions in our Bayesian model.
The priors for the planet parameters are defined conditional on the values
of the hyperparameters. Uniform priors were used for parameters like phases.
For parameters where a rough initial guess is possible, heavy-tailed Cauchy
distributions were used so this information could be taken into account
in a non-dogmatic way. Time units are in days and amplitude units are
in metres per second. The maximum number of planets, $N_{\rm max}$, was set
to 10. The prior limits for $m_0$ were set to the minimum and maximum value
in the dataset, which is not strictly a valid strategy.\label{tab:priors}}
\end{table*}

\section{Orbit Look-Up Table}\label{sec:orbits}
The expected (noise-free) signal due to an exoplanet is periodic, but
non-sinusoidal when the orbit is not perfectly circular. The expected
shape $m(t)$ of the variations is needed in order to evaluate the likelihood
function for any proposed setting of the parameters.
To save time, we pre-computed the properties of orbits as a function of
ellipticity. We also made the standard assumption that the planets do not
interact, so the expected signal due to several planets is the sum of the
contributions of each planet.

Consider a test particle moving in the $x$-$y$ plane under the influence of a
point mass at the origin. The motion of the test particle represents the
reflex motion of the host star orbiting around the center of mass of the
system. The equations of motion for the particle are:
\begin{eqnarray}
\frac{d^2x}{dt^2} &=& -\frac{x}{r^3} \\
\frac{d^2y}{dt^2} &=& -\frac{y}{r^3} \\
\end{eqnarray}
where $r = \sqrt{x^2 + y^2}$. The solutions to this system of equations are elliptical orbits
with the focus at the origin. We set the initial position to $(1, 0)$, and
the initial velocity to $(0, v)$ where $v \in [0.4, 1]$.
If $v=1$, the orbit is circular and as $v$ decreases the orbit becomes more
elliptical. For trial values of $v$ ranging from 0.4 to 1 in steps of 0.005,
we calculated the orbit, and saved the
velocities $\frac{dx}{dt}$ and $\frac{dy}{dt}$ as a function of time to disk.
These saved orbits were used as a lookup table for constructing the expected
signal $y(t)$ due to a single planet.
Because of the initial conditions, the simulated orbits were all horizontally
aligned. If the observer is located on the $x$-axis a large distance
from the origin, they will measure $m(t) = \dot{x}(t)$. However, if the
observer is located at an angle $\omega$ with respect to the $x$-axis, then
the radial velocity measured will instead be
$m(t) = \cos(\omega)\dot{x}(t) + \sin(\omega)\dot{y}(t)$.
Since the our orientation with respect to the orbits is unknown, each planet
requires a ``viewing angle'' parameter $\omega$ also known as the longitude
of the line of sight \citep{ohta}.
The eccentricity of the orbit, in terms of $v$, is $e = 1 - v^2$.
By precomputing a set of orbits before running the MCMC, we are able to
do $\sim$ 15,000 likelihood evaluations per second per CPU core.

\section{Demonstration on Simulated Data}\label{sec:fake_data}
To test our proposed methodology, we generated a simulated dataset for a
system with $N=7$ planets. The dataset was ``inspired by'' the $\nu$ Oph
dataset (Section~\ref{sec:nu_oph}), and contains two large signals with
periods of 530 and 3120 days, whose semi-amplitudes are
291 m s$^{-1}$ and 181 m s$^{-1}$ respectively. The other five planets have
much lower semi-amplitudes, ranging from 4-30 ms$^{-1}$. The standard deviation
for the noise in the data was 5 m s$^{-1}$, so some of these low-amplitude
signals should be detectable. The simulated data is shown in
Figure~\ref{fig:fake_data}, along with the true radial velocity curve $m(t)$
that was used to generate the data.

\begin{figure}
\includegraphics[scale=0.4]{Figures/fake_data.eps}
\caption{A simulated dataset that ``resembles'' the $\nu$ Oph dataset, which
we used to test our methodology. The dominant signal is from two large
planets with periods periods of 530 and 3120 days and semi-amplitudes of
291 m s$^{-1}$ and 181 m s$^{-1}$ respectively. There are also five
much smaller planets which contribute small additional effects to the data.
\label{fig:fake_data}}
\end{figure}

We ran the MCMC on the simulated dataset to obtain samples from the
posterior distribution. We obtained 520 posterior samples.
The posterior distribution for $N$, the number of
planets, is shown in Figure~\ref{fig:fake_data_N}. The true number of planets,
7, is not the most probable value, but it does have substantial probability.
The posterior distribution suggests that $N$ could be anywhere from 6 to 10.
The posterior distribution for the periods $\{P_i\}_{i=1}^N$ is shown in
Figure~\ref{fig:fake_data_periods}. Because of the label switching degeneracy,
the posterior distribution for each period is identical, so we pooled the
samples for all periods. Defining the log-periods by
$S_i =  \log_{10}\left[P_i/(\textnormal{1 day})\right]$,
Figure~\ref{fig:fake_data_periods} is a Monte Carlo representation
of the mixture distribution
\begin{eqnarray}
f(S) &=& \sum_{N=0}^{10} p(N | D)\sum_{i=1}^N p(S_i | N, D).
\end{eqnarray}
The posterior distribution for the periods, shown in
Figure~\ref{fig:fake_data_periods}, shows that six of the true periods were
recovered, with probability close to 1. One period (with $\log_{10}P_i \approx 1.15$)
which was actually present was not ``detected'' because it had a very small
amplitude. We note that the posterior probability near this period should not be
precisely zero. There is also some
evidence for periods which did not actually exist, however the posterior
probabilities for these peaks are not close to 1.

\begin{figure}
\includegraphics[scale=0.4]{Figures/fake_data_N.eps}
\caption{The posterior distribution for the number of planets $N$ given the
simulated dataset. The true number of planets was 7.
\label{fig:fake_data_N}}
\end{figure}

\begin{figure}
\includegraphics[scale=0.4]{Figures/fake_data_periods.eps}
\caption{The posterior distribution for the periods given the simulated
dataset. The solid lines are the true periods, six of which were detected
with high posterior probability.\label{fig:fake_data_periods}}
\end{figure}

The joint posterior distribution for the periods and the amplitudes of the
signals is shown in Figure~\ref{fig:fake_data_posterior} along with the
eccentricities. As with Figure~\ref{fig:fake_data_periods}, the samples for
all planets were combined. The true values are also plotted as circles. Clearly, the
reason the period of $\log_{10}(P_i) \approx 1.15$ was not ``detected'' was that
it had a very low amplitude of approximately 4 m s$^{-1}$ which is below the
noise level.

\begin{figure}
\includegraphics[scale=0.4]{Figures/fake_data_posterior.eps}
\caption{The joint posterior distribution for the periods and the amplitudes
(top panel) and the periods and eccentricities (bottom panel) from the
simulated dataset. The true values are plotted as circles.
\label{fig:fake_data_posterior}}
\end{figure}


\section{Application to $\nu$ Oph}\label{sec:nu_oph}
The $\nu$ Oph system is generally accepted to have two confirmed planets
\citep[e.g.][]{2011AIPC.1331..102Q, 2012PASJ...64..135S, fengji}, with periods
of $530.3$ and $3190$ days. To test our approach we applied it to the RV
data from \citet{2012PASJ...64..135S}.
The posterior distribution for $N$, the number of planets, is shown in
Figure~\ref{fig:nu_oph_N}, showing that $N$ could be anywhere from 2 to 10,
and the posterior probability that $N \geq 3$ is about 88\%. Of course, these
extra possible signals are not necessarily a planet but a feature in the data
which is better explained by a periodic signal than by noise (and may have been
explained by correlated noise, had we included it).

The posterior distribution for the logarithms of the periods is shown in
Figure~\ref{fig:nu_oph_periods}. As in Section~\ref{sec:fake_data},
the posterior samples for all periods were combined to make this figure, which
shows several prominent peaks. 
The two peaks with vertical dashed lines are the commonly accepted periods of
530 and 3190 days, and the other prominent peaks (i.e. signals which have a
moderate probability of existence) have periods of 36.11 $\pm$ 0.034 days,
75.58 $\pm$ 0.80 days, and 1709 $\pm$ 183 days.
The probability that
at least one of these ``extra'' signals exists, given by the fraction of
samples that have one of these signals, is 85\%.
Given that they exist, their amplitudes are low, around 5-40 metres per second,
which we note is above the noise level. An example model fit to the data is
shown in Figure~\ref{fig:nuoph}.

\begin{figure}
\includegraphics[scale=0.45]{Figures/nu_oph_N.eps}
\caption{The posterior distribution for the number of planets $N$ orbiting
$\nu$ Oph. The posterior probability of $N > 2$ is about 88\%, however the
prior probability of $N > 2$ was already high due to the uniform prior for $N$.
\label{fig:nu_oph_N}}
\end{figure}

\begin{figure}
\includegraphics[scale=0.45]{Figures/nu_oph_periods.eps}
\caption{The posterior distribution for the orbital periods in the $\nu$ Oph
system. The two dashed vertical lines are the commonly accepted periods
of $530.3$ and $3190$ days. The next most prominent peaks with well determined
periods are at log periods of around 1.6, 2.4, and 3.3, corresponding to
periods of 36.11 $\pm$ 0.034 days,
75.58 $\pm$ 0.80 days, and 1709 $\pm$ 183 days.\label{fig:nu_oph_periods}}
\end{figure}

\begin{figure}
\includegraphics[scale=0.45]{Figures/nuoph.eps}
\caption{The $\nu$ Oph radial velocity data and an example model fit which
includes a third period. The amplitude of this additional signal is low but
is about twice the reported errorbars on the measurements.\label{fig:nuoph}}
\end{figure}

\begin{figure}
\includegraphics[scale=0.45]{Figures/logl0.eps}
\caption{Log likelihood vs. enclosed prior mass (a standard output of Nested
Sampling algorithms) for the $\nu$ Oph analysis.
There are several phase transitions (concave-up regions) present. The one at
$\log(X) \approx -70$ separates models which contain additional signals from
models that do not. Without using Nested Sampling it would be more difficult
to mix between these two situations and calculate the posterior probability
for the existence of the additional signals.
\label{fig:logl0}}
\end{figure}

Figure~\ref{fig:logl0} shows the relationship between the likelihood $L$
and the enclosed prior mass $X$ for the $\nu$ Oph analysis. These plots are
a standard output of Nested Sampling analyses, and provide
insights into the structure of the problem. Concave-up regions of this curve
indicate phase transitions which can cause severe problems for annealing-based
methods, and sometimes even for sampling the posterior distribution. In this
analysis, the models with a third signal exist to the left of the phase
transition at $\log(X) \approx -70$, and models without the signal exist to the
right of the phase transition. Mixing between these two phases is crucial for
accurately computing the posterior probability that extra signals exist.

The marginal likelihood for our model was
$\log(\mathcal{Z}) \approx -220.5$. Nested Sampling also allows for calculation
of the ``information'', or Kullback-Leibler divergence (a quantity in information
theory) from the prior to the posterior, which quantifies how much we learned about the parameters:
\begin{eqnarray}
\mathcal{H} &=& \int p(\theta | D) \log\left[\frac{p(\theta | D)}{p(\theta)}\right] \, d\theta
\end{eqnarray}
An intuitive interpretation of this quantity is the number of times the
prior distribution had to be compressed by a factor of $e$ (if the logarithm
in the formula is a natural logarithm) to get to the posterior distribution.
For the $\nu$ Oph data the information was $\mathcal{H} \approx 76.6$ nats
(natural units) or 111 bits, so the posterior is roughly $e^{-76.6}$ times the
volume of the prior.

\section{Application to Gliese 581}
The red dwarf star Gliese 581 is thought to host several planets. Exactly
how many is a matter of considerable debate. According to
\citet{2014Sci...345..440R}, there are two planets
(b and c, with periods 5.36 and 12.91 days respectively)
whose existence is generally
accepted, two more
(d and e, with periods 66 and 3.15 days respectively)
whose existence was mostly accepted, and another two
(f and g, with periods 433 and 36.5 days respectively)
whose existence was generally doubted. However, \citet{2014Sci...345..440R}
found that planets d and g do not exist but are signals due to stellar activity.
While our model cannot account for stellar variability and contribute to that
particular discussion, it is a challenging and interesting dataset from an
inference point of view.
To run our code on the combined dataset from the HARPS and HIRES spectrographs,
we extended the model to include separate DC offsets for each instrument, as
well as separate ``extra noise'' parameters $s_0$ and $\nu$. We also increased
$N_{\rm max}$ from 10 to 15 for this system.

The posterior distribution for $N$ is shown in Figure~\ref{fig:gliese581_N},
and shows strong evidence for at least eight periods
($P(N \leq 7 | D) = 0.012$).
It is now recognised that
there are many possible sources for oscillations in a data set and not all
such oscillations should be claimed as planets \citep{2014Sci...345..440R}. 
Our model cannot distinguish between oscillations due to planets and
oscillations due to stellar activity: any oscillations found in the dataset
will be described as ``planets'' by the model. However it is interesting that
we find many more signals in the data than previous authors.

By inspecting the posterior distribution for the periods
(Figure~\ref{fig:gliese581_periods}), we see that only four of the periods
are well determined, corresponding to the known periods of Gliese 581 b, c, d,
and e. The other ``periods'' are very uncertain. It is possible that a
non-sinusoidal signal due to stellar activity is being modelled as several
periods \citep{astero}, and if the model were extended to include a ``stochastic''
oscillation \citep{gaussproc}, the number of periods detected may be reduced
substantially. An example model fit for Gliese 581 is shown in
Figure~\ref{fig:gliese581}.

\begin{figure}
\includegraphics[scale=0.45]{Figures/gliese581_N.eps}
\caption{The posterior distribution for the number of planets $N$ orbiting
Gliese 581.\label{fig:gliese581_N}}
\end{figure}

\begin{figure}
\includegraphics[scale=0.45]{Figures/gliese581_periods.eps}
\caption{The posterior distribution for the orbital periods in the Gliese 581
system. The solid lines are Gliese 581 b and c, the dashed lines are
``planets'' d and e, and the dotted lines are f and g.
\label{fig:gliese581_periods}}
\end{figure}


\begin{figure}
\includegraphics[scale=0.45]{Figures/gliese581.eps}
\caption{A portion of the Gliese 581 data and an example model fit.
\label{fig:gliese581}}
\end{figure}


The marginal likelihood was $\log(\mathcal{Z}) \approx -616.3$ and the
information was $\mathcal{H} \approx 130.4$ nats. This compares favourably
to the marginal likelihood of $-640.1$ (for a 6-planet model)
found by \citet{fengji}, although it is unclear whether we used exactly the
same dataset.
Interestingly, the log-likelihood curve (Figure~\ref{fig:logl})
shows this problem has two phase transitions. While these do not affect the
posterior distribution (as they did for $\nu$ Oph), they would cause difficulties
if we tried to calculte the marginal likelihood using annealing.

\begin{figure}
\includegraphics[scale=0.45]{Figures/logl.eps}
\caption{Log likelihood vs. enclosed prior mass for the Gliese 581 analysis.
The two concave-up regions (at $\log(X) \approx -25$ and -45) correspond to
phase transitions. Thermal approaches to this problem would produce misleading
estimates of the marginal likelihood because they would mix poorly at temperatures
around 11 and 4.
\label{fig:logl}}
\end{figure}


\section{Conclusions}
In this paper we introduced a trans-dimensional MCMC approach to inferring
the number of planets $N$ in an exoplanetary system from radial velocity data.
The MCMC was implemented using the framework of \citet{rjobject} which
defines trans-dimensional birth and death moves, and does the sampling
with respect to a Nested Sampling target distribution, rather than directly
sampling the posterior. This approach allows us to compute the results in a
single run, which provides posterior samples and an estimate of the marginal
likelihood. By embedding the MCMC in a Nested Sampling algorithm, instead of
directly trying to sample the posterior distribution, we can overcome difficult
features in the problem, such as phase transitions.

We applied the code to two well-studied RV datasets, $\nu$ Oph and Gliese 581.
In $\nu$ Oph, we found some evidence for additional signals with low amplitude,
but with several possible solutions for their periods. Given our modelling
assumptions, the posterior probability at least one of these additional signals
is real is 85\%. The posterior distribution contains models both with and without
these additional signals, however, these are separated by a phase transition.
Therefore mixing between the two situations would be infrequent if we simply
tried to sample the posterior distribution.

With the combined HIRES+HARPS dataset from Gliese 581, we found
evidence for a large number of ``planets'', although only four have well
determined periods, corresponding to the Gliese 581 b, c, d,
and e. Since our model does not include any possibility of stellar variability,
any such periodic signals will be attributed to ``planets''.
Including non-planetary stellar variability is a crucial next step.

\vspace{-0.5cm}
\section*{Acknowledgements}
It is a pleasure to thank Fengji Hou and David Hogg (NYU) for inspiring me (BJB) to
finally work on this problem, and Phil Gregory (UBC) for writing so many
interesting papers on it. We also thank Tom Loredo (Cornell) and Dan
Foreman-Mackey (NYU) for interesting conversations and feedback, and Ben
Montet (Caltech) and Geraint Lewis (Sydney) for helpful discussions.
The referee also provided excellent suggestions for improving the manuscript.

This work was supported by a Marsden Fast Start
grant from the Royal Society of
New Zealand.

\begin{thebibliography}{99}
\bibitem[\protect\citeauthoryear{Batalha}{2014}]{2014PNAS..11112647B} 
Batalha N.~M., 2014, PNAS, 111, 12647 

\bibitem[\protect\citeauthoryear{Bennett et 
al.}{2014}]{2014ApJ...785..155B} Bennett D.~P., et al., 2014, ApJ, 785, 155 

\bibitem[\protect\citeauthoryear{Brewer 
\& Stello}{2009}]{gaussproc} Brewer B.~J., Stello D., 2009, MNRAS, 395, 2226 

\bibitem[\protect\citeauthoryear{Brewer et al.}{2007}]{astero} 
Brewer B.~J., Bedding T.~R., Kjeldsen H., Stello D., 2007, ApJ, 654, 551 

\bibitem[\protect\citeauthoryear{Brewer, P{\'a}rtay,
\& Cs{\'a}nyi}{2011}]{dnest} Brewer B.~J., P{\'a}rtay L.~B., Cs{\'a}nyi G., 2011,
Statistics and Computing, 21, 4, 649-656. arXiv:0912.2380

\bibitem[\protect\citeauthoryear{Brewer}{2014}]{rjobject} Brewer, B. J., 2014,
submitted. ArXiv: 1411.3921

\bibitem[\protect\citeauthoryear{Feroz 
\& Hobson}{2014}]{2014MNRAS.437.3540F} Feroz F., Hobson M.~P., 2014, MNRAS, 437, 3540 

\bibitem[\protect\citeauthoryear{Feroz, Balan, 
\& Hobson}{2011}]{2011MNRAS.415.3462F} Feroz F., Balan S.~T., Hobson M.~P., 2011, MNRAS, 415, 3462

\bibitem[\protect\citeauthoryear{Green}{1995}]{green}
Green, P.~J., 1995, Reversible Jump Markov Chain Monte Carlo Computation and Bayesian Model Determination, Biometrika 82 (4): 711â€“732.

\bibitem[\protect\citeauthoryear{Gregory}{2011}]{2011MNRAS.415.2523G} 
Gregory P.~C., 2011, MNRAS, 415, 2523 

\bibitem[\protect\citeauthoryear{Gregory}{2011}]{2011MNRAS.410...94G} 
Gregory P.~C., 2011, MNRAS, 410, 94 

\bibitem[\protect\citeauthoryear{Hou, Goodman, 
\& Hogg}{2014}]{fengji} Hou F., Goodman J., Hogg D.~W., 2014, arXiv, arXiv:1401.6128 

\bibitem[\protect\citeauthoryear{Kipping}{2013}]{kipping} 
Kipping D.~M., 2013, MNRAS, 434, L51 

\bibitem[\protect\citeauthoryear{Neal}{2001}]{neal}
Neal, R.~M., 2001, Statistics and Computing 11.2, 125-139.

\bibitem[\protect\citeauthoryear{O'Hagan and Forster}{2004}]{ohagan}
O'Hagan, A., Forster,~J., 2004, Bayesian inference. London: Arnold.

\bibitem[\protect\citeauthoryear{Ohta, Taruya, 
\& Suto}{2005}]{ohta} Ohta Y., Taruya A., Suto Y., 2005, ApJ, 622, 1118

\bibitem[\protect\citeauthoryear{Quirrenbach, Reffert, 
\& Bergmann}{2011}]{2011AIPC.1331..102Q} Quirrenbach A., Reffert S., Bergmann C., 2011, AIPC, 1331, 102 

\bibitem[\protect\citeauthoryear{Robertson et 
al.}{2014}]{2014Sci...345..440R} Robertson P., Mahadevan S., Endl M., Roy 
A., 2014, Sci, 345, 440 

\bibitem[\protect\citeauthoryear{Sato et al.}{2012}]{2012PASJ...64..135S} 
Sato B., et al., 2012, PASJ, 64, 135 

\bibitem[\protect\citeauthoryear{Sivia \& Skilling}{2006}]{sivia} Sivia, 
D.~ S., Skilling, J., 2006, Data Analysis: A Bayesian Tutorial, 2nd 
Edition, Oxford University Press

\bibitem[\protect\citeauthoryear{Skilling}{2006}]{skilling} Skilling, 
J., 2006, ``Nested Sampling for General Bayesian Computation'', Bayesian 
Analysis 4, pp. 833-860

\bibitem[Stephens(2000)]{birthdeath} Stephens, M., 2000, ``Bayesian analysis of mixture models with an unknown number of components-an alternative to reversible jump methods.'', Annals of Statistics, 40-74.

\bibitem[\protect\citeauthoryear{Tuomi}{2011}]{2011A&A...528L...5T} Tuomi M., 2011, A\&A, 528, L5 

\bibitem[\protect\citeauthoryear{Umst{\"a}tter et 
al.}{2005}]{umstatter} Umst{\"a}tter R., Christensen N., Hendry 
M., Meyer R., Simha V., Veitch J., Vigeland S., Woan G., 2005, PhRvD, 72, 
022001 

\bibitem[\protect\citeauthoryear{Yee et al.}{2014}]{2014ApJ...790...14Y} 
Yee J.~C., et al., 2014, ApJ, 790, 14 

\bibitem[\protect\citeauthoryear{Zechmeister \& K{\"u}rster}{2009}]{2009A&A...496..577Z} Zechmeister M., K{\"u}rster M., 2009, A\&A, 496, 577  

\end{thebibliography}



\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% DATA USED

% Nu Oph
% Time (days), Radial velocity (m/s), Radial velocity errorbar (m/s)
%2.337364819999999781e+03 -2.061999999999999886e+02 4.299999999999999822e+00
%2.487101369999999861e+03 2.615000000000000000e+02 4.200000000000000178e+00
%2.507077150000000074e+03 3.403000000000000114e+02 3.799999999999999822e+00
%2.541955269999999928e+03 4.198999999999999773e+02 5.799999999999999822e+00
%2.541958299999999781e+03 4.293999999999999773e+02 4.000000000000000000e+00
%2.736306950000000143e+03 -2.519999999999999929e+01 5.299999999999999822e+00
%2.857037139999999908e+03 -2.150000000000000000e+01 5.000000000000000000e+00
%3.100276800000000094e+03 5.113000000000000114e+02 3.700000000000000178e+00
%3.499178260000000137e+03 1.225000000000000000e+02 5.299999999999999822e+00
%3.636025169999999889e+03 3.305000000000000000e+02 6.200000000000000178e+00
%3.963951230000000123e+03 -2.350999999999999943e+02 4.900000000000000355e+00
%4.309113010000000031e+03 -2.686999999999999886e+02 5.200000000000000178e+00
%4.338994730000000345e+03 -3.363999999999999773e+02 3.399999999999999911e+00
%4.560239679999999680e+03 -1.160000000000000000e+02 3.500000000000000000e+00
%4.588269440000000031e+03 -2.230000000000000071e+01 5.000000000000000000e+00
%4.674023040000000037e+03 1.691999999999999886e+02 4.099999999999999645e+00
%4.674025380000000041e+03 1.686999999999999886e+02 4.099999999999999645e+00
%4.677067339999999604e+03 1.716999999999999886e+02 3.799999999999999822e+00
%4.928330149999999776e+03 -3.908000000000000114e+02 3.500000000000000000e+00
%4.952301330000000235e+03 -3.595000000000000000e+02 4.500000000000000000e+00
%4.953310220000000299e+03 -3.531999999999999886e+02 4.099999999999999645e+00
%5.132930250000000342e+03 7.940000000000000568e+01 6.700000000000000178e+00
%5.267333859999999731e+03 1.450000000000000000e+02 3.500000000000000000e+00
%5.296329950000000281e+03 4.579999999999999716e+01 3.500000000000000000e+00
%5.324284969999999703e+03 -3.520000000000000284e+01 4.000000000000000000e+00
%5.347153669999999693e+03 -1.170000000000000000e+02 4.099999999999999645e+00
%5.384187179999999898e+03 -1.946999999999999886e+02 4.200000000000000178e+00
%5.398047959999999875e+03 -2.165999999999999943e+02 3.700000000000000178e+00
%5.436026149999999689e+03 -2.645000000000000000e+02 3.500000000000000000e+00
%5.467928210000000036e+03 -2.518000000000000114e+02 3.700000000000000178e+00
%5.613381190000000061e+03 6.979999999999999716e+01 3.500000000000000000e+00
%5.656341529999999693e+03 2.221999999999999886e+02 3.299999999999999822e+00
%5.657340799999999945e+03 2.265000000000000000e+02 3.799999999999999822e+00
%5.690210130000000390e+03 3.385000000000000000e+02 6.000000000000000000e+00
%5.712159810000000107e+03 4.010000000000000000e+02 3.799999999999999822e+00
%5.763070190000000366e+03 3.993000000000000114e+02 3.399999999999999911e+00
%5.766075829999999769e+03 3.908999999999999773e+02 3.600000000000000089e+00
%5.770066890000000058e+03 3.886000000000000227e+02 4.000000000000000000e+00
%5.784950219999999717e+03 3.693000000000000114e+02 4.099999999999999645e+00
%5.787005500000000211e+03 3.641999999999999886e+02 3.600000000000000089e+00
%5.788002169999999751e+03 3.663000000000000114e+02 3.700000000000000178e+00
%5.804928630000000339e+03 2.938000000000000114e+02 3.799999999999999822e+00
%5.809972679999999855e+03 2.825000000000000000e+02 3.700000000000000178e+00
%5.846919119999999566e+03 1.640999999999999943e+02 4.900000000000000355e+00

% Gliese 581
% First 122 points are HIRES, then HARPS follows
%1409.76222   6.96 1.89 
%1586.14605 -10.24 3.22 
%1704.91213   0.47 2.89 
%2003.95507  -4.37 3.65 
%2100.86678 -19.45 2.22 
%2161.73096   3.35 2.19 
%2162.73165  10.73 2.38 
%2335.15024   6.87 2.33 
%2487.79326  -7.30 3.77 
%2712.05433 -10.96 2.10 
%2828.87708   7.75 2.25 
%3077.15398  -7.18 3.18 
%3239.82508  -2.50 2.60 
%3426.14551  -2.74 4.82 
%3748.16323  -4.97 1.96 
%3754.14596  -8.68 1.97 
%3932.80588   2.40 1.95 
%3960.83771  12.14 1.90 
%3961.77279   4.38 1.57 
%3962.77418  -4.97 2.40 
%3963.81985  -9.92 1.78 
%3982.78069  14.04 1.92 
%4130.14636 -14.79 1.84 
%4131.16220  -4.58 2.58 
%4139.16155   1.60 1.92 
%4246.81907  -4.50 1.18 
%4247.92767  -9.21 1.84 
%4248.82815  -7.84 1.48 
%4249.90281   6.45 1.38 
%4250.81292  18.17 1.95 
%4251.81942   7.61 1.30 
%4255.79771   7.35 3.62 
%4277.76996  17.11 1.68 
%4278.78138  14.06 1.71 
%4279.78247 -10.60 2.03 
%4285.78969 -15.08 2.54 
%4294.84381  -0.04 2.04 
%4300.81847  -0.76 1.83 
%4304.79872  16.63 2.24 
%4305.80545   2.61 1.45 
%4306.83201  -8.05 2.31 
%4307.83943  -8.03 1.47 
%4308.82016   1.74 1.27 
%4309.80568  13.32 1.26 
%4310.80271  11.19 1.26 
%4311.79457  -4.40 1.23 
%4312.79306  -7.14 1.13 
%4313.80176   8.14 1.45 
%4314.82230  13.67 1.35 
%4318.79357  -5.91 1.44 
%4335.75166   5.83 1.35 
%4336.78425  14.68 1.84 
%4339.72676  -8.58 2.69 
%4343.74861  -0.29 2.06 
%4345.74397  -5.82 1.94 
%4461.17458   3.57 2.13 
%4545.09518   4.98 1.95 
%4546.07813  17.48 1.52 
%4547.07715   9.06 2.74 
%4547.99454  -3.97 2.45 
%4600.98896  13.54 2.03 
%4601.90368  -8.33 2.69 
%4633.86049  -6.47 1.49 
%4634.86134 -12.30 1.27 
%4635.87975  -5.69 1.19 
%4636.88690  12.26 2.07 
%4637.88502  15.38 1.56 
%4638.94288  -1.08 1.40 
%4639.91382 -11.27 1.39 
%4640.92943  -6.50 1.95 
%4641.90267   5.64 1.33 
%4643.88456   0.95 1.74 
%4666.84246  -7.60 1.25 
%4667.84194  -8.11 2.07 
%4671.85435  -9.71 1.33 
%4672.83453  -3.24 1.00 
%4673.84973   8.11 1.03 
%4686.82794   2.60 2.22 
%4688.77854  -9.57 1.96 
%4689.77880   3.13 1.29 
%4701.79211  17.51 1.17 
%4702.81250  11.35 1.72 
%4703.80853  -1.73 1.54 
%4704.80341  -7.99 1.20 
%4717.72887  14.81 1.48 
%4718.73784   5.10 2.03 
%4719.73866  -4.93 1.86 
%4720.73430 -14.79 1.46 
%4721.73009  -9.86 1.33 
%4722.74036   3.80 1.58 
%4723.73908   6.85 1.62 
%4903.15067 -14.41 2.08 
%5021.91811 -10.11 1.43 
%5022.91286   1.39 1.86 
%5024.95012   9.32 1.57 
%5049.86010   4.91 0.90 
%5050.80706  13.45 0.79 
%5051.84043   5.28 1.17 
%5052.86710  -8.12 2.09 
%5053.79905 -10.89 0.80 
%5201.15720  16.10 1.58 
%5202.15734   9.80 1.61 
%5203.14807  -8.37 1.53 
%5258.15584   2.44 2.22 
%5260.13379  16.54 2.11 
%5338.81312  -4.84 0.53 
%5338.90357  -3.10 1.59 
%5338.98795  -1.62 1.33 
%5339.06181  -1.56 1.82 
%5340.05371   9.91 1.63 
%5340.86600  11.62 1.38 
%5340.95260   9.87 0.58 
%5341.03351   6.69 0.76 
%5341.79524  -1.63 0.80 
%5342.00395  -1.67 0.88 
%5342.06383  -5.26 1.46 
%5369.93610 -15.90 1.40 
%5370.87580 -14.21 1.48 
%5371.93429   6.73 1.13 
%5408.89194  -0.40 2.00 
%5409.76684  15.21 1.48 
%5409.86682  15.68 1.98 
%3.152712894000113010e+3 -1.076949579832486847e+01 1.100000000000000089e+00
%3.158663459999952465e+03 -1.927949579832421989e+01 1.199999999999999956e+00
%3.511773341000080109e+03 -7.469495798325453961e+00 1.199999999999999956e+00
%3.520744746000040323e+03 9.360504201675112768e+00 1.300000000000000044e+00
%3.573512039000168443e+03 -7.194957983251981659e-01 1.199999999999999956e+00
%3.574522328999824822e+03 8.800504201674996807e+00 1.100000000000000089e+00
%3.575480748999863863e+03 3.360504201674885394e+00 1.000000000000000000e+00
%3.576536046000197530e+03 -7.339495798325046394e+00 1.000000000000000000e+00
%3.577592602999880910e+03 -1.124949579832446034e+01 1.199999999999999956e+00
%3.578510712999850512e+03 -8.694957983248485789e-01 9.000000000000000222e-01
%3.578629602000117302e+03 1.740504201675818763e+00 1.100000000000000089e+00
%3.579462557000108063e+03 1.217050420167531399e+01 9.000000000000000222e-01
%3.579621048999950290e+03 1.388050420167452614e+01 1.000000000000000000e+00
%3.585461769999936223e+03 5.590504201675727813e+00 1.000000000000000000e+00
%3.586465158000122756e+03 -3.939495798324088582e+00 6.999999999999999556e-01
%3.587464703999925405e+03 -1.753949579832436712e+01 1.399999999999999911e+00
%3.588538062000181526e+03 -8.759495798324579141e+00 2.299999999999999822e+00
%3.589462024000007659e+03 4.800504201675437344e+00 6.999999999999999556e-01
%3.590463895000051707e+03 1.240050420167548850e+01 8.000000000000000444e-01
%3.591466483999975026e+03 6.640504201675057061e+00 6.999999999999999556e-01
%3.592464813000056893e+03 -6.219495798324814473e+00 8.000000000000000444e-01
%3.606551678999792784e+03 1.405050420167519576e+01 1.899999999999999911e+00
%3.607507526999805123e+03 9.530504201675782383e+00 1.000000000000000000e+00
%3.608482642999850214e+03 -4.709495798325136207e+00 1.199999999999999956e+00
%3.609488452000077814e+03 -1.422949579832533118e+01 1.500000000000000000e+00
%3.757877319000195712e+03 3.670504201675584000e+00 1.000000000000000000e+00
%3.760875475000124425e+03 -3.069495798325050373e+00 1.300000000000000044e+00
%3.761859215999953449e+03 6.250504201675610716e+00 1.300000000000000044e+00
%3.811846942999865860e+03 4.690504201676048979e+00 1.199999999999999956e+00
%3.813827016999945045e+03 -1.071949579832498500e+01 9.000000000000000222e-01
%3.830836957000195980e+03 -2.109495798324090288e+00 9.000000000000000222e-01
%3.862701441000215709e+03 -5.994957983244120214e-01 9.000000000000000222e-01
%3.864713661999907345e+03 1.355050420167458469e+01 1.000000000000000000e+00
%3.867752171000000089e+03 -9.449495798325102669e+00 1.100000000000000089e+00
%3.870696603000164032e+03 5.030504201675611853e+00 1.100000000000000089e+00
%3.882657763000112027e+03 -1.153949579832413974e+01 9.000000000000000222e-01
%3.887690737999975681e+03 -5.299495798324116436e+00 9.000000000000000222e-01
%3.918621751000173390e+03 7.230504201675813647e+00 1.100000000000000089e+00
%3.920594947000034153e+03 -1.805949579832422103e+01 1.000000000000000000e+00
%3.945543122000060976e+03 9.820504201675461786e+00 1.000000000000000000e+00
%3.951485927000176162e+03 5.480504201674563092e+00 9.000000000000000222e-01
%3.975471595999784768e+03 -7.649495798323968643e+00 1.000000000000000000e+00
%3.979543974999804050e+03 -8.039495798325191345e+00 1.199999999999999956e+00
%4.166874181999824941e+03 -1.481949579832431141e+01 1.100000000000000089e+00
%4.170853961000218987e+03 7.430504201675347531e+00 9.000000000000000222e-01
%4.194872349000070244e+03 -1.367949579832483664e+01 1.100000000000000089e+00
%4.196750384000129998e+03 1.457050420167504967e+01 1.199999999999999956e+00
%4.197845038999803364e+03 1.538050420167458299e+01 1.199999999999999956e+00
%4.198855508999899030e+03 -3.269495798324584257e+00 1.199999999999999956e+00
%4.199732869000174105e+03 -5.909495798324115867e+00 1.000000000000000000e+00
%4.200910914999898523e+03 -2.694957983244705702e-01 1.000000000000000000e+00
%4.201868553999811411e+03 9.050504201676190519e+00 1.000000000000000000e+00
%4.202882594999857247e+03 1.327050420167452671e+01 1.000000000000000000e+00
%4.228741560999769717e+03 8.380504201674909837e+00 1.100000000000000089e+00
%4.229700478000100702e+03 1.080050420167566472e+01 1.399999999999999911e+00
%4.230762136000208557e+03 -1.799495798325168039e+00 1.000000000000000000e+00
%4.234645916000008583e+03 1.381050420167539983e+01 1.100000000000000089e+00
%4.253633167999796569e+03 -9.309495798325073679e+00 1.000000000000000000e+00
%4.254664809999987483e+03 -4.359495798324175553e+00 1.000000000000000000e+00
%4.291568849999923259e+03 -7.179495798323998201e+00 1.300000000000000044e+00
%4.292590813999995589e+03 -4.949579832391748369e-02 9.000000000000000222e-01
%4.293625868000090122e+03 9.980504201674733622e+00 1.000000000000000000e+00
%4.295639448000118136e+03 -1.049949579832443192e+01 1.100000000000000089e+00
%4.296606114000082016e+03 -2.112949579832523739e+01 1.199999999999999956e+00
%4.297641939000226557e+03 -7.539495798324580278e+00 1.000000000000000000e+00
%4.298567600000184029e+03 7.790504201675929608e+00 1.100000000000000089e+00
%4.299622194999828935e+03 1.060050420167613083e+01 1.500000000000000000e+00
%4.300619109999854118e+03 1.005042016757329293e-01 1.000000000000000000e+00
%4.315507493999786675e+03 1.331050420167478876e+01 1.600000000000000089e+00
%4.317480847000144422e+03 -8.449495798323880535e+00 1.000000000000000000e+00
%4.319490526999812573e+03 2.190504201674770002e+00 1.300000000000000044e+00
%4.320544071999844164e+03 1.182050420167612970e+01 1.000000000000000000e+00
%4.323507050000131130e+03 -1.125949579832408176e+01 3.200000000000000178e+00
%4.340555780999828130e+03 -1.549495798323974327e+00 9.000000000000000222e-01
%4.342486204000189900e+03 1.844050420167597792e+01 1.000000000000000000e+00
%4.349515163000207394e+03 -1.179949579832495488e+01 1.000000000000000000e+00
%4.530855659999884665e+03 6.150504201675843774e+00 1.000000000000000000e+00
%4.550831273999996483e+03 6.140504201676222351e+00 9.000000000000000222e-01
%4.553803722000215203e+03 -1.330949579832463314e+01 8.000000000000000444e-01
%4.563838002000004053e+03 -3.339495798325486930e+00 9.000000000000000222e-01
%4.566761146999895573e+03 1.505042016756164003e-01 1.100000000000000089e+00
%4.567791670999955386e+03 8.300504201676162097e+00 1.000000000000000000e+00
%4.569793302000034600e+03 -1.422949579832533118e+01 1.000000000000000000e+00
%4.570804248000029474e+03 -1.572949579832538802e+01 1.000000000000000000e+00
%4.571818376000039279e+03 3.530504201675555009e+00 1.100000000000000089e+00
%4.587861967999953777e+03 2.970504201675439049e+00 1.500000000000000000e+00
%4.588838798999786377e+03 8.170504201675754530e+00 1.100000000000000089e+00
%4.589827492999844253e+03 5.160504201676019420e+00 1.100000000000000089e+00
%4.590819633999839425e+03 -5.959495798323999338e+00 1.000000000000000000e+00
%4.591817119999788702e+03 -2.045949579832395671e+01 1.500000000000000000e+00
%4.592827337000053376e+03 -8.829495798325481815e+00 9.000000000000000222e-01
%4.610742932000197470e+03 1.883050420167542427e+01 1.100000000000000089e+00
%4.611713477000128478e+03 8.080504201675609011e+00 9.000000000000000222e-01
%4.616713028000202030e+03 8.550504201675579452e+00 1.300000000000000044e+00
%4.639686739000026137e+03 -1.078949579832411132e+01 1.100000000000000089e+00
%4.640654409000184387e+03 -1.055949579832393681e+01 1.300000000000000044e+00
%4.641631705999840051e+03 2.030504201675498166e+00 1.000000000000000000e+00
%4.643644998000003397e+03 2.210504201675789204e+00 1.300000000000000044e+00
%4.644587028000038117e+03 -1.027949579832387883e+01 1.199999999999999956e+00
%4.646625357000157237e+03 -7.129495798324114730e+00 1.199999999999999956e+00
%4.647579119000118226e+03 7.150504201675289551e+00 1.100000000000000089e+00
%4.648484817000105977e+03 9.600504201674908700e+00 1.100000000000000089e+00
%4.661553706000093371e+03 -1.198949579832486734e+01 1.199999999999999956e+00
%4.662549407999962568e+03 -7.094957983238003862e-01 1.300000000000000044e+00
%4.663544865999836475e+03 1.364050420167473021e+01 1.100000000000000089e+00
%4.664553042000159621e+03 1.352050420167572042e+01 1.199999999999999956e+00
%4.665569376000203192e+03 5.950504201674533533e+00 1.000000000000000000e+00
%4.672531723000109196e+03 -5.569495798324552993e+00 1.800000000000000044e+00
%4.674524120000191033e+03 9.440504201675636864e+00 1.300000000000000044e+00
%4.677505113999824971e+03 -8.939495798324870179e+00 1.100000000000000089e+00
%4.678556785000022501e+03 1.560504201675527725e+00 1.100000000000000089e+00
%4.679504033999983221e+03 1.368050420167499226e+01 1.500000000000000000e+00
%4.681514142999891192e+03 3.410504201674768865e+00 1.399999999999999911e+00
%4.682503343000076711e+03 -7.349495798324667817e+00 1.300000000000000044e+00
%4.701485073999967426e+03 1.412050420167609843e+01 1.199999999999999956e+00
%4.703513042000122368e+03 -2.069495798323828240e+00 1.199999999999999956e+00
%4.708479050000198185e+03 -4.589495798324350062e+00 1.199999999999999956e+00
%4.721473032999783754e+03 -1.558949579832535903e+01 1.199999999999999956e+00
%4.722472370999865234e+03 2.590504201675614127e+00 1.100000000000000089e+00
